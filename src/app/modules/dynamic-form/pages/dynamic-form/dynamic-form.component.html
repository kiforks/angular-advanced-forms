<div class="action-buttons">
	<button (click)="onLoadUserClick()" type="button">Load User Form</button>
	<button (click)="onLoadCompanyClick()" type="button">Load Company Form</button>
</div>

<div *ngIf="formConfig$ | async as formConfig" class="dynamic-form-container">
	<form [formGroup]="formConfig.form" (ngSubmit)="onSubmit(formConfig.form)">
		<h3 class="form-heading">{{ formConfig.config.description }}</h3>

		<ng-container *ngFor="let control of formConfig.config.controls | keyvalue : comparator">
			<ng-container [dynamicFormControl]="{ control: control.value, key: control.key }"></ng-container>

			<div
				*ngIf="
					formConfig.form.get(control.key)?.dirty && formConfig.form.get(control.key)?.hasError('required')
				"
				class="input-error"
			>
				This field is required
			</div>
			<div
				*ngIf="formConfig.form.get(control.key)?.dirty && formConfig.form.get(control.key)?.hasError('email')"
				class="input-error"
			>
				It must be a valid email
			</div>
			<div
				*ngIf="
					formConfig.form.get(control.key)?.dirty && formConfig.form.get(control.key)?.hasError('minlength')
				"
				class="input-error"
			>
				The field must be at least
				{{ formConfig.form.get(control.key)?.getError('minlength').requiredLength }} characters
			</div>
			<div
				*ngIf="
					formConfig.form.get(control.key)?.dirty && formConfig.form.get(control.key)?.hasError('banWords')
				"
				class="input-error"
			>
				This word is not allowed
			</div>
		</ng-container>

		<button [disabled]="formConfig.form.invalid">Save</button>
	</form>
</div>
